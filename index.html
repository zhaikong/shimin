
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>同心县12345便民热线 - 态势感知系统</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>

    <style>
        :root {
            --bg-color: #051437;
            --primary-glow: #25D5E4;
            --secondary-glow: #E31937;
            --border-color: rgba(37, 213, 228, 0.3);
            --module-bg: rgba(5, 20, 55, 0.5);
            --font-family-sans: 'Poppins', 'Noto Sans SC', sans-serif;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes ticker-scroll {
            0% { transform: translateY(0); }
            100% { transform: translateY(-100%); }
        }
        @keyframes slide-up {
            0% { transform: translateY(100%); opacity: 0; }
            5% { transform: translateY(0); opacity: 1; }
            33% { transform: translateY(0); opacity: 1; }
            38% { transform: translateY(-100%); opacity: 0; }
            100% { transform: translateY(-100%); opacity: 0; }
        }

        body {
            font-family: var(--font-family-sans);
            background-color: var(--bg-color);
            color: #fff;
            background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M50 0 L100 25 L100 75 L50 100 L0 75 L0 25 Z" fill="none" stroke="rgba(37, 213, 228, 0.05)" stroke-width="1"/></svg>');
            background-size: 300px;
            overflow: hidden;
            animation: fadeIn 1s ease-in-out;
        }

        .module {
            background-color: var(--module-bg);
            border: 1px solid var(--border-color);
            position: relative;
            backdrop-filter: blur(5px);
            padding: 1.5rem;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .module::before, .module::after {
            content: '';
            position: absolute;
            width: 1.5rem;
            height: 1.5rem;
            border-color: var(--primary-glow);
            border-style: solid;
        }
        .module::before { top: -2px; left: -2px; border-width: 2px 0 0 2px; }
        .module::after { bottom: -2px; right: -2px; border-width: 0 2px 2px 0; }

        .module-header {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--primary-glow);
            margin-bottom: 1rem;
            padding-left: 0.75rem;
            border-left: 3px solid var(--primary-glow);
            flex-shrink: 0;
        }

        .module-body {
            flex-grow: 1;
            min-height: 0;
        }


        .metrics-carousel {
            position: relative;
            height: 100%;
            overflow-y: auto;
            scroll-behavior: smooth;
            scrollbar-width: none; /* Firefox */
        }
        
        .metrics-carousel::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Edge */
        }
        
        .metric-slide {
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            scroll-snap-align: start;
        }
        
        .metric-value {
            font-size: 6rem; /* 增大字体大小 */
            font-weight: 700;
            font-family: 'Poppins', sans-serif;
            color: var(--secondary-glow);
            text-shadow: 0 0 20px var(--secondary-glow); /* 增强发光效果 */
            margin-bottom: 0.5rem;
            line-height: 1;
        }
        
        .metric-label {
            font-size: 1.5rem;
            color: #ffffff;
            opacity: 0.8;
        }
        
        .live-ticker .ticker-item {
            padding: 0.75rem 0.5rem;
            border-bottom: 1px solid var(--border-color);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* --- Responsive adjustments for mobile --- */
        @media (max-width: 767px) {
            body { overflow: auto; }
            .metric-value { font-size: 3rem; }
            .metric-label { font-size: 1rem; }
            .module { padding: 1rem; }
        }
    </style>
</head>
<body class="p-4">

    <main class="w-full min-h-screen md:h-[calc(100vh-2rem)] grid grid-cols-1 md:grid-cols-12 md:grid-rows-12 gap-4">

        <header class="col-span-12 row-span-1 flex justify-center items-center">
            <h1 class="text-2xl md:text-3xl lg:text-4xl font-bold text-cyan-300 text-center px-4" 
                style="text-shadow: 0 0 10px rgba(37, 213, 228, 0.8);">
                同心县12345便民热线态势感知系统
            </h1>
        </header>

        <div class="col-span-1 md:col-span-3 md:row-span-11 grid gap-4 md:grid-rows-3">
            <div class="module row-span-1">
                <h2 class="module-header">核心指标</h2>
                <div class="module-body text-center">
                    <div id="metrics-carousel" class="metrics-carousel">
                        <div class="metric-slide">
                            <p id="total-complaints" class="metric-value">2,161</p>
                            <p class="metric-label">总投诉量 (件)</p>
                </div>
                        <div class="metric-slide">
                            <p id="daily-avg" class="metric-value">67.5</p>
                            <p class="metric-label">平均每日 (件)</p>
                </div>
                        <div class="metric-slide">
                            <p id="timespan" class="metric-value">32</p>
                            <p class="metric-label">时间跨度 (天)</p>
                </div>
                </div>
                </div>
            </div>
            <div class="module row-span-2">
                <h2 class="module-header">高频热点问题</h2>
                 <ul id="hotspot-list" class="h-full overflow-y-auto divide-y divide-[var(--border-color)] pr-2">
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">1.</span> 道路问题</span>
                            <span class="font-bold text-red-500">583</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 道路损坏、积水、施工影响、交通拥堵</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立道路损坏快速修复机制</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">2.</span> 小区管理问题</span>
                            <span class="font-bold text-red-500">415</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 物业管理、服务态度、收费不透明</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立物业服务质量评价体系</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">3.</span> 行政审批问题</span>
                            <span class="font-bold text-red-500">179</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 手续繁琐、审批时间长、费用争议</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 推行"一窗受理、集成服务"机制</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">4.</span> 教育问题</span>
                            <span class="font-bold text-red-500">149</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 入学困难、教学质量、学校管理</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 完善教育资源配置，提升教学质量</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">5.</span> 其他问题</span>
                            <span class="font-bold text-red-500">134</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 医疗、交通、司法、家庭暴力等各类问题</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立综合问题处理机制</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">6.</span> 供水问题</span>
                            <span class="font-bold text-red-500">122</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 水费异常、停水、水质问题、水表故障</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立水费异常快速核查机制</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">7.</span> 信息公开问题</span>
                            <span class="font-bold text-red-500">98</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 信息不透明、查询困难、咨询无果</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立信息公开机制，提升透明度</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">8.</span> 欠薪问题</span>
                            <span class="font-bold text-red-500">90</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 农民工工资拖欠、企业欠薪行为</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立欠薪预警机制，加强劳动监察执法</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">9.</span> 噪音扰民问题</span>
                            <span class="font-bold text-red-500">87</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 施工噪音、机械噪音、扰民严重</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 严格夜间施工时间管控</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">10.</span> 土地问题</span>
                            <span class="font-bold text-red-500">70</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 征地补偿、拆迁安置、土地纠纷</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 规范征地程序，完善补偿标准</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">11.</span> 补贴问题</span>
                            <span class="font-bold text-red-500">47</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 育儿补贴、低保申请、救助金发放</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 完善补贴申请流程，提升发放效率</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">12.</span> 垃圾处理问题</span>
                            <span class="font-bold text-red-500">28</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 垃圾清理不及时、分类管理混乱</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立垃圾处理标准化流程</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">13.</span> 环境卫生问题</span>
                            <span class="font-bold text-red-500">26</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 环境脏乱、清洁不及时</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立环境卫生长效管理机制</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">14.</span> 房产问题</span>
                            <span class="font-bold text-red-500">25</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 产权纠纷、过户困难、交易问题</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 简化房产交易流程，加强产权保护</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">15.</span> 医疗问题</span>
                            <span class="font-bold text-red-500">25</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 医院服务、医疗质量、医患纠纷</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 提升医疗服务质量，建立医患沟通机制</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">16.</span> 网络通信问题</span>
                            <span class="font-bold text-red-500">19</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 网络信号差、套餐问题、服务态度</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立网络信号质量监测体系</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">17.</span> 马庄村专项问题</span>
                            <span class="font-bold text-red-500">16</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 垃圾填埋、土地承包费、停水问题</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 成立专项治理工作组，45天内解决</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">18.</span> 路灯问题</span>
                            <span class="font-bold text-red-500">12</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 路灯损坏、照明不足</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立路灯维护巡查机制</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">19.</span> 设施问题</span>
                            <span class="font-bold text-red-500">11</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 基础设施老化、电梯故障、监控缺失</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立设施维护台账，定期检查</p>
                        </div>
                    </li>
                    <li class="py-2">
                        <div class="flex justify-between items-baseline text-lg">
                            <span><span class="font-bold text-cyan-300">20.</span> 公益性岗位问题</span>
                            <span class="font-bold text-red-500">10</span>
                        </div>
                        <div class="pl-5 mt-1 text-sm text-gray-400 space-y-1">
                            <p><span class="font-semibold text-cyan-400/80 mr-1">突出问题:</span> 岗位分配不透明、管理不规范</p>
                            <p><span class="font-semibold text-cyan-400/80 mr-1">建议:</span> 建立公益性岗位公开透明分配机制</p>
                        </div>
                    </li>
                 </ul>
            </div>
        </div>

        <div class="col-span-1 md:col-span-6 md:row-span-11 grid gap-4 md:grid-rows-2">
            <div class="module row-span-1">
                <h2 class="module-header">诉求类型分布</h2>
                <div class="module-body">
                    <div id="typeChart" class="w-full h-full"></div>
                </div>
            </div>
            <div class="module row-span-1">
                <h2 id="hourly-chart-title" class="module-header">投诉时段分布 (高峰: 17时)</h2>
                <div id="hourlyChart" class="w-full module-body h-64 md:h-full"></div>
        </div>
        </div>

        <div class="col-span-1 md:col-span-3 md:row-span-11 grid gap-4 md:grid-rows-3">
            <div class="module row-span-1">
                <h2 class="module-header">紧急程度分析</h2>
                <div id="urgency-panel" class="module-body flex justify-around items-center text-center">
                    <div>
                        <p class="text-4xl font-bold text-cyan-300">93.1%</p>
                        <p class="text-gray-400 mt-2">一般工单 (2,012)</p>
        </div>
                     <div>
                        <p class="text-4xl font-bold text-red-500">6.9%</p>
                        <p class="text-gray-400 mt-2">紧急工单 (149)</p>
                </div>
                </div>
                </div>
            <div class="module row-span-2 overflow-hidden">
                <h2 class="module-header">最新工单动态</h2>
                <div class="module-body relative overflow-hidden h-64 md:h-full">
                    <div class="live-ticker absolute inset-0">
                </div>
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- SCRIPT START ---

        // DATA SOURCE FOR LIVE TICKER (from 月.json)
        const liveDataJson = {
          "Sheet1": [
            { "诉求标题": "反映同心县中国移动退费问题", "诉求类型": "求助", "交办时间": "2025-10-13 16:23:05" },
            { "诉求标题": "反映同心县豫海镇城北村水坑存在安全隐患问题", "诉求类型": "求助", "交办时间": "2025-10-13 16:22:08" },
            { "诉求标题": "反映同心县火车站附近施工噪音扰民的问题", "诉求类型": "求助", "交办时间": "2025-10-13 16:08:45" },
            { "诉求标题": "反映同心县河西镇同德村村民申请四胎育儿补贴未通过的问题", "诉求类型": "求助", "交办时间": "2025-10-13 16:06:29" },
            { "诉求标题": "反映同心县信泰家园小区水费异常的问题", "诉求类型": "求助", "交办时间": "2025-10-13 15:55:36" },
            { "诉求标题": "反映同心县韦州镇马庄村沟渠堆满垃圾问题", "诉求类型": "求助", "交办时间": "2025-10-13 15:51:21" },
            { "诉求标题": "反映同心县团结北街体育广场周边栏杆影响住户车辆停放问题", "诉求类型": "求助", "交办时间": "2025-10-13 15:48:57" },
            { "诉求标题": "投诉同心县碧桂圆商网处暖气频繁损坏无法正常通暖问题", "诉求类型": "投诉", "交办时间": "2025-10-13 15:45:37" },
            { "诉求标题": "反映同心县政务服务中心54号窗口工作人员使用市民身份证查询他人信息的问题", "诉求类型": "求助", "交办时间": "2025-10-13 15:44:36" },
            { "诉求标题": "举报同心县\"信泰达桌球俱乐部\"允许未成年进入的问题", "诉求类型": "举报", "交办时间": "2025-10-13 15:42:34" },
            { "诉求标题": "投诉同心县新区家园A区上一任住户暖气费未缴清问题", "诉求类型": "投诉", "交办时间": "2025-10-13 15:41:52" },
            { "诉求标题": "反映同心县信泰家园小区水费异常的问题", "诉求类型": "求助", "交办时间": "2025-10-13 15:30:10" },
            { "诉求标题": "投诉同心县自来水公司要求市民缴纳上一个住户产生水费问题", "诉求类型": "投诉", "交办时间": "2025-10-13 15:27:51" },
            { "诉求标题": "投诉同心县\"宁夏德晖新能源科技发展有限公司\"拖欠工资问题", "诉求类型": "投诉", "交办时间": "2025-10-13 15:19:19" },
            { "诉求标题": "反映同心县丁塘镇湾段头村水费异常的问题", "诉求类型": "求助", "紧急程度": "紧急", "交办时间": "2025-10-13 15:17:59" }
          ]
        };
        
        // Main function to initialize the dashboard
        function initializeDashboard() {
            
            // --- 1. INTERACTIVITY: Animated Counters ---
            function animateValue(obj, start, end, duration) {
                if (!obj) return;
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    obj.innerHTML = Math.floor(progress * (end - start) + start).toLocaleString();
                    if (progress < 1) window.requestAnimationFrame(step);
                };
                window.requestAnimationFrame(step);
            }
            function animateDecimalValue(obj, start, end, duration) {
                if (!obj) return;
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    obj.innerHTML = (progress * (end - start) + start).toFixed(1);
                    if (progress < 1) window.requestAnimationFrame(step);
                };
                window.requestAnimationFrame(step);
            }

            // Using static data from the main report summary
            animateValue(document.getElementById('total-complaints'), 0, 2161, 1500);
            animateDecimalValue(document.getElementById('daily-avg'), 0, 67.5, 1500);
            animateValue(document.getElementById('timespan'), 0, 32, 1500);
            
            // --- 1.5. NEW: Auto-scroll for Core Metrics ---
            const metricsCarousel = document.getElementById('metrics-carousel');
            if (metricsCarousel) {
                const slides = metricsCarousel.querySelectorAll('.metric-slide');
                if (slides.length > 1) {
                    let currentSlide = 0;
                    setInterval(() => {
                        currentSlide = (currentSlide + 1) % slides.length;
                        // Use scrollTo for smooth transition
                        metricsCarousel.scrollTo({
                            top: slides[currentSlide].offsetTop,
                            behavior: 'smooth'
                        });
                    }, 4000); // Change slide every 4 seconds
                }
            }
            
            // 添加滚动捕获样式
            document.getElementById('metrics-carousel').style.scrollSnapType = 'y mandatory';


            // --- 3. INTERACTIVITY: Live Ticker ---
            const tickerContainer = document.querySelector('.live-ticker');
            if (tickerContainer && liveDataJson && liveDataJson.Sheet1) {
                const liveRecords = liveDataJson.Sheet1;
                let tickerHTML = '';
                for (let i = 0; i < 3; i++) { // duplicate for smooth scroll
                     liveRecords.forEach(r => {
                        const timeDiff = Math.floor((new Date("2025-10-14T09:00:00Z") - new Date(r['交办时间'])) / (1000 * 60));
                        const timeAgo = timeDiff > 60 ? `${Math.floor(timeDiff/60)}小时前` : `${timeDiff}分钟前`;
                        tickerHTML += `<div class="ticker-item flex justify-between">
                                        <span class="text-cyan-300">[${r['诉求类型']}]</span>
                                        <span class="flex-1 mx-2">${r['诉求标题']}</span>
                                        <span class="text-gray-500">${timeAgo}</span>
                                    </div>`;
                    });
                }
                tickerContainer.innerHTML = tickerHTML;
                const totalHeight = tickerContainer.scrollHeight / 3;
                tickerContainer.style.animation = `ticker-scroll ${totalHeight / 35}s linear infinite`;
            }

            // --- 4. ECHARTS INITIALIZATION ---
            const commonOptions = {
                textStyle: { fontFamily: 'Poppins, Noto Sans SC', color: '#fff' },
                grid: { left: '3%', right: '4%', bottom: '5%', top: '15%', containLabel: true },
                backgroundColor: 'transparent'
            };

            // Hourly Chart - 使用真实数据
            const hourlyChartDom = document.getElementById('hourlyChart');
            let hourlyChart;
            if (hourlyChartDom) {
                hourlyChart = echarts.init(hourlyChartDom);
                const hourlyOption = {
                    ...commonOptions,
                    tooltip: { trigger: 'axis', backgroundColor: 'rgba(5, 20, 55, 0.8)', borderColor: 'var(--border-color)' },
                    xAxis: {
                        type: 'category',
                        data: ['0h', '1h', '2h', '3h', '4h', '5h', '6h', '7h', '8h', '9h', '10h', '11h', '12h', '13h', '14h', '15h', '16h', '17h', '18h', '19h', '20h', '21h', '22h', '23h'],
                        axisLine: { lineStyle: { color: 'var(--border-color)' } },
                        axisLabel: { color: '#ccc', interval: 1 }
                    },
                    yAxis: {
                        type: 'value',
                        axisLine: { show: true, lineStyle: { color: 'var(--border-color)' } },
                        splitLine: { lineStyle: { color: 'rgba(37, 213, 228, 0.1)' } },
                        axisLabel: { color: '#ccc' }
                    },
                    series: [{
                        name: '投诉量', type: 'bar', 
                        data: [8, 3, 2, 0, 2, 0, 2, 20, 74, 217, 227, 201, 119, 64, 185, 170, 193, 375, 132, 55, 36, 30, 26, 20],
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(37, 213, 228, 0.8)' },
                                { offset: 1, color: 'rgba(37, 213, 228, 0.1)' }
                            ]),
                            borderRadius: [2, 2, 0, 0],
                        },
                        emphasis: { focus: 'series', itemStyle: { color: 'var(--primary-glow)', shadowColor: 'var(--primary-glow)', shadowBlur: 10 } }
                    }]
                };
                hourlyChart.setOption(hourlyOption);
            }
            
            // Type Chart - 使用真实数据
            const typeChartDom = document.getElementById('typeChart');
            let typeChart;
            if (typeChartDom) {
                typeChart = echarts.init(typeChartDom);
                const typeData = [
                    { value: 1447, name: '求助' }, { value: 570, name: '投诉' }, { value: 81, name: '举报' },
                    { value: 37, name: '建议' }, { value: 22, name: '咨询' }, { value: 4, name: '表扬' }
                ];
                const typeOption = {
                    ...commonOptions,
                tooltip: {
                    trigger: 'item',
                        formatter: function(params) {
                            return `<div style="padding: 10px;">
                                <div style="font-size: 16px; font-weight: bold; color: #25D5E4; margin-bottom: 8px;">${params.data.name}</div>
                                <div style="font-size: 24px; font-weight: bold; color: #fff; margin-bottom: 4px;">${params.data.value.toLocaleString()} 件</div>
                                <div style="font-size: 14px; color: #ccc;">占比 ${params.percent}%</div>
                            </div>`;
                        },
                        backgroundColor: 'rgba(5, 20, 55, 0.9)',
                        borderColor: 'var(--border-color)',
                        borderWidth: 1,
                    textStyle: { color: '#fff' }
                },
                    legend: { show: false },
                series: [{
                    name: '诉求类型',
                    type: 'pie',
                        radius: ['60%', '80%'], 
                        center: ['50%', '50%'],
                    avoidLabelOverlap: false,
                    itemStyle: {
                            borderRadius: 5, 
                            borderColor: 'var(--bg-color)', 
                            borderWidth: 4 
                        },
                        label: {
                            show: true,
                            position: 'outside',
                            formatter: '{b}\n{d}%',
                            fontSize: 12,
                            color: '#fff'
                        }, 
                    emphasis: {
                            scaleSize: 10,
                        itemStyle: {
                                shadowBlur: 20,
                                shadowColor: 'rgba(37, 213, 228, 0.5)'
                            }
                        }, 
                        data: typeData,
                    }],
                    color: ['#E31937', '#25D5E4', '#1E90FF', '#FFD700', '#9370DB', '#32CD32']
                };
                typeChart.setOption(typeOption);
            }

            // --- 5. Window Resize Handler ---
            window.addEventListener('resize', () => {
                if(hourlyChart) { hourlyChart.resize(); }
                if(typeChart) { typeChart.resize(); }
            });
        }

        // Robust way to run the script after the page is fully loaded.
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeDashboard);
        } else {
            initializeDashboard();
        }

    </script>
</body>
</html>
